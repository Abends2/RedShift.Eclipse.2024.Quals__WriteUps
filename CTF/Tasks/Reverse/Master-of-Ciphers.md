# Master-of-Ciphers

***Описание***: Я давно ~~(не мылся)~~ не видел света из-за постоянной работы. Ситуация странная - в мой офис налетели люди в погонах и стали требовать от меня разобраться в том, как работает эта странная программа. Эти люди, на самом деле, мои старые приятели еще с университета. Я не могу подвести их, мне необходимо разобраться... 

Формат: EclipseCTF{...}

---
### Решение - Этап 1. Исследование исходного кода

При анализе мы можем обнаружить следующую функцию:

![ScreenShot](Assets/For_Tasks/master-of-ciphers-1.png)

Результат данной функции мы и видим в файле. Алгоритм довольно простой, но что-то странное происходит с аргументом `a[3]`. Продолжая анализ мы понимаем, что это просто 3 функции, которые объявлены ранее в коде.

![ScreenShot](Assets/For_Tasks/master-of-ciphers-2.png)

![ScreenShot](Assets/For_Tasks/master-of-ciphers-3.png)

![ScreenShot](Assets/For_Tasks/master-of-ciphers-4.png)

### Решение - Этап 2. Воссоздание хешированной строки

Теперь имея на руках все необходимые функции, мы можешь воссоздать алгоритм широфвания и подобрать исходную строку, но есть проблема- у нас нет ключа. В процессе исследования программы мы должны были наткнутся на данные функции:

![ScreenShot](Assets/For_Tasks/master-of-ciphers-5.png)

![ScreenShot](Assets/For_Tasks/master-of-ciphers-6.png)

![ScreenShot](Assets/For_Tasks/master-of-ciphers-7.png)

На первый взгляд данная функция кажется просто огромной, но при дальнейшем анализе можно разбить ее на 2 функции - функция которая превращает ключ в читаемый вид, и функция которая обфусцирует ключ для дальнейшего использования. Как итог, мы можем воссоздать функцию требуемые для восстановления строки.

В результате, либо методом подбора, либо создав функции дешифровки, получаем следующую строку:

```
3cffffffa61cffffffbfffffffe6ffffffedffffffea4ffffffc7c2fffffff8fffffff8d33538a5453fffffff51effffff8dffffffd653a546f54affffffed545d
```

Однако на флаг это не очень похоже

### Решение - Этап 3. Брут хэша

Это строка формируется из вышеуказанных функций, однако есть еще одна, и именно она работает с введенными данными:

![ScreenShot](Assets/For_Tasks/master-of-ciphers-8.png)

![ScreenShot](Assets/For_Tasks/master-of-ciphers-9.png)

![ScreenShot](Assets/For_Tasks/master-of-ciphers-10.png)

![ScreenShot](Assets/For_Tasks/master-of-ciphers-11.png)

![ScreenShot](Assets/For_Tasks/master-of-ciphers-12.png)

В результате преобразования этой функции(придется покопаться в ассемблере), будет примерно такая функция:

![ScreenShot](Assets/For_Tasks/master-of-ciphers-13.png)

Как итог, можно легко подобрать или использовать флаг

---

***Флаг***: `EclipseCTF{y0u_ar3_go0d_r3v3rs3}`