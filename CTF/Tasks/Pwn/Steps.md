# Steps

***Описание***: Как много шагов в этой непонятной штуке. Хорошо, что я умею это всё обходить)

Подключение: `nc localhost:10809` 

---
### Решение

Это задание представляет собой серверное приложение, которое позволяет шифровать сообщения и просматривать их в зашифрованном виде. Программа содержит ряд уязвимостей, включая переполнение буфера, уязвимость форматной строки и некорректную обработку ввода. Участникам необходимо эксплуатировать эти уязвимости последовательно, чтобы разблокировать шаги и получить флаг.

Алгоритм решения следующий: 
1. **Переполнение буфера**: Начальная точка атаки - использование функции `gets()`, которая уязвима к переполнению буфера. Отправляя достаточное количество символов, можно перезаписать локальную переменную `step1_unlocked` для разблокировки следующего шага. Следует использовать 64 символа `A`, за которыми следует байт `\x01`, чтобы установить переменную в необходимое состояние.
2. **Эксплуатация Encrypt message**: После разблокировки первого шага следует использовать функцию шифрования сообщения. Ввод простого текстового сообщения и заголовка активирует `step2_unlocked`, позволяя перейти к следующему шагу.
3. **Форматная строка**: Для использования уязвимости форматной строки необходимо ввести специально подготовленную строку в качестве номера сообщения, например `%x-%x-%x`. Это приводит к выводу данных из стека, что потенциально может разблокировать следующий шаг.
4. **Получение флага**: Финальный шаг включает запрос на просмотр "секретного" сообщения посредством ввода "0" после активации всех предыдущих шагов. В результате сервер выводит флаг.

---

***Флаг***: `EclipseCTF{All_Step3_Complet3d_1s_n1se_sceel}`